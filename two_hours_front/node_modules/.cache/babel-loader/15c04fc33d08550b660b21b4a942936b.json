{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Ckeditor4 from \"@/components/Ckeditor4\";\nexport default {\n  name: 'AdmCourseTab',\n  components: {\n    Ckeditor4: Ckeditor4\n  },\n  data: function data() {\n    return {\n      // 当前页码\n      currentPage: 1,\n      // 分页大小\n      pageSize: 10,\n      // 总页码数\n      totalCount: 99,\n      // 搜索表单数据模型\n      searchTitle: {\n        courseName: ''\n      },\n      // 内置查询模型\n      searchByCourseName: {\n        courseName: ''\n      },\n      // 数据列表\n      tableData: []\n    };\n  },\n  created: function created() {\n    this.getCourseByTitle();\n  },\n  methods: {\n    // 查找课程\n    // 系统内置一个title，默认为空，即全查询。每次条件查询都会把条件赋给该title。\n    // 因此这样点击分页栏时可以正常显示查询结果。\n    getCourseByTitle: function getCourseByTitle() {\n      var _this = this;\n\n      this.searchByCourseName[\"pageSize\"] = this.pageSize;\n      this.searchByCourseName[\"currentPage\"] = this.currentPage;\n      this.$axios.post(\"/CourseView/getPageByCondition\", this.searchByCourseName).then(function (res) {\n        if (res.data.flag) {\n          /* 保存公告数据 */\n          _this.tableData = res.data.data.records;\n          /* 保存分页数据 */\n\n          _this.totalCount = res.data.data.total;\n          _this.currentPage = res.data.data.current;\n          _this.pageSize = res.data.data.size;\n        } else {\n          // 服务故障\n          _this.$message.error(\"信息获取失败！\");\n        }\n      });\n    },\n    // 表格颜色控制\n    tableRowClassName: function tableRowClassName(_ref) {\n      var row = _ref.row,\n          rowIndex = _ref.rowIndex;\n\n      if (rowIndex % 4 === 1) {\n        return 'warning-row';\n      } else if (rowIndex % 4 === 3) {\n        return 'success-row';\n      }\n\n      return '';\n    },\n    // 查询课程\n    searchOnSubmit: function searchOnSubmit(courseName) {\n      // 刷新查询条件\n      this.searchByCourseName.courseName = courseName; // 执行查询\n\n      this.getCourseByTitle();\n      /* 清空查询条件 */\n\n      this.searchTitle.courseName = '';\n    },\n    // 课程管理\n    courseManage: function courseManage(course) {\n      var _this2 = this;\n\n      // 添加课程id到session\n      this.$axios.post(\"/CourseView/addCourseIdToSession\", course).then(function (res) {\n        if (res.data.flag) {\n          _this2.$router.push({\n            name: 'AdmCourseManage',\n            params: {\n              courseId: course.courseId\n            }\n          });\n        } else {\n          // 服务故障\n          _this2.$message.error(\"服务处理失败，请重新尝试T_T\");\n        }\n      });\n    },\n    // 更新课程状态\n    updateCourseState: function updateCourseState(course) {\n      var _this3 = this;\n\n      // 更新状态\n      course.isStart = course.isStartBool ? 1 : 0;\n      var newCourse = {\n        courseId: course.courseId,\n        isStart: course.isStart\n      };\n      this.$axios.post(\"/Course/updateInfo\", newCourse).then(function (res) {\n        if (res.data.flag) {\n          // 修改成功\n          _this3.$message.success(res.data.msg);\n        } else {\n          // 服务故障\n          _this3.$message.error(res.data.msg);\n        }\n      });\n    },\n    // 删除课程\n    deleteCourse: function deleteCourse(row) {\n      var _this4 = this;\n\n      // 弹框确认\n      this.$confirm('此操作将永久删除该课程及其所有数据，其所含学生将自动退出该课程, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        var course = {\n          courseId: row.courseId\n        }; // 执行删除\n\n        _this4.$axios.post(\"/Course/deleteCourseById\", course).then(function (resp) {\n          if (resp.data.flag) {\n            // 删除成功，刷新数据\n            _this4.getCourseByTitle();\n\n            _this4.$message.success('删除成功！');\n          } else {\n            _this4.$message.error('删除失败！');\n          }\n        });\n      }).catch(function () {\n        // 取消删除\n        _this4.$message.info('取消删除');\n      });\n    },\n    // 分页大小变化\n    handleSizeChange: function handleSizeChange(val) {\n      this.pageSize = val; // 查询所有课程\n\n      this.getCourseByTitle();\n    },\n    // 当前页变化\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.currentPage = val; // 查询所有课程\n\n      this.getCourseByTitle();\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2FA;AACA;AACAA,sBADA;AAEAC;AACAC;AADA,GAFA;AAKAC,MALA,kBAKA;AACA;AACA;AACAC,oBAFA;AAGA;AACAC,kBAJA;AAKA;AACAC,oBANA;AAOA;AACAC;AACAC;AADA,OARA;AAWA;AACAC;AACAD;AADA,OAZA;AAeA;AACAE;AAhBA;AAkBA,GAxBA;AAyBAC,SAzBA,qBAyBA;AACA;AACA,GA3BA;AA4BAC;AACA;AACA;AACA;AACAC,oBAJA,8BAIA;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA,SAPA,MAOA;AACA;AACA;AACA;AACA,OAZA;AAaA,KApBA;AAqBA;AACAC,qBAtBA,mCAsBA;AAAA;AAAA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;;AACA;AACA,KA7BA;AA8BA;AACAC,kBA/BA,0BA+BAP,UA/BA,EA+BA;AACA;AACA,sDAFA,CAGA;;AACA;AACA;;AACA;AACA,KAtCA;AAuCA;AACAQ,gBAxCA,wBAwCAC,MAxCA,EAwCA;AAAA;;AACA;AACA;AACA;AACA;AACAjB,mCADA;AAEAkB;AACAC;AADA;AAFA;AAMA,SAPA,MAOA;AACA;AACA;AACA;AACA,OAZA;AAaA,KAvDA;AAwDA;AACAC,qBAzDA,6BAyDAH,MAzDA,EAyDA;AAAA;;AACA;AACAA;AACA;AACAE,iCADA;AAEAE;AAFA;AAIA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA;AACA,OARA;AASA,KAzEA;AA0EA;AACAC,gBA3EA,wBA2EAC,GA3EA,EA2EA;AAAA;;AACA;AACA;AACAC,+BADA;AAEAC,8BAFA;AAGAC;AAHA,SAIAC,IAJA,CAIA;AACA;AAAAR;AAAA,UADA,CAEA;;AACA;AACA;AACA;AACA;;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA,SARA;AASA,OAhBA,EAgBAS,KAhBA,CAgBA;AACA;AACA;AACA,OAnBA;AAoBA,KAjGA;AAkGA;AACAC,oBAnGA,4BAmGAC,GAnGA,EAmGA;AACA,0BADA,CAEA;;AACA;AACA,KAvGA;AAwGA;AACAC,uBAzGA,+BAyGAD,GAzGA,EAyGA;AACA,6BADA,CAEA;;AACA;AACA;AA7GA;AA5BA","names":["name","components","Ckeditor4","data","currentPage","pageSize","totalCount","searchTitle","courseName","searchByCourseName","tableData","created","methods","getCourseByTitle","tableRowClassName","searchOnSubmit","courseManage","course","params","courseId","updateCourseState","isStart","deleteCourse","row","confirmButtonText","cancelButtonText","type","then","catch","handleSizeChange","val","handleCurrentChange"],"sourceRoot":"src/pages/admin/components","sources":["AdmCourseTab.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <!-- 功能菜单 -->\r\n        <el-row style=\"position: relative; height: 90px\">\r\n            <!--搜索表单-->\r\n            <el-col :span=\"8\">\r\n                <el-form :inline=\"true\" :model=\"searchTitle\" id=\"file-form-select\">\r\n                    <el-form-item label=\"搜索内容\">\r\n                        <el-input v-model=\"searchTitle.courseName\" placeholder=\"名称\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item>\r\n                        <el-button type=\"primary\" @click=\"searchOnSubmit(searchTitle.courseName)\">查询</el-button>\r\n                    </el-form-item>\r\n                    <el-form-item>\r\n                        <el-button type=\"success\" @click=\"searchOnSubmit('')\">重置</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </el-col>\r\n        </el-row>\r\n\r\n        <!--表格-->\r\n        <template>\r\n            <el-table\r\n                    :data=\"tableData\"\r\n                    style=\"width: 100%\"\r\n                    :row-class-name=\"tableRowClassName\">\r\n                <el-table-column\r\n                        label=\"序号\"\r\n                        type=\"index\"\r\n                        align=\"center\"\r\n                        width=\"100\">\r\n                </el-table-column>\r\n\r\n                <el-table-column\r\n                        prop=\"courseName\"\r\n                        label=\"名称\"\r\n                        align=\"center\"\r\n                        sortable\r\n                        width=\"400\">\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"username\"\r\n                        label=\"创建者\"\r\n                        align=\"center\"\r\n                        sortable>\r\n                </el-table-column>\r\n                <el-table-column\r\n                        label=\"状态\"\r\n                        align=\"center\" style=\"position: relative\">\r\n                    <template slot-scope=\"scope\">\r\n                        <span style=\"margin-right: 0.5em\">{{scope.row.isStartStr}}</span>\r\n                        <el-switch class=\"tableSwitch\" v-model=\"scope.row.isStartBool\" @change=\"updateCourseState(scope.row)\"></el-switch>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column\r\n                        prop=\"formatDate\"\r\n                        label=\"创建日期\"\r\n                        align=\"center\"\r\n                        sortable>\r\n                </el-table-column>\r\n\r\n                <el-table-column\r\n                        align=\"center\"\r\n                        label=\"操作\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button type=\"text\" style=\"font-size: 16px\" @click=\"courseManage(scope.row)\">\r\n                            <i style=\"margin:0 0.2em\" class=\"el-icon-menu\"></i>管理</el-button>\r\n                        <el-button type=\"text\" style=\"color: #afafaf;font-size: 16px\" @click=\"deleteCourse(scope.row)\">\r\n                            <i style=\"margin:0 0.2em\" class=\"el-icon-delete\"></i>删除</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n\r\n            </el-table>\r\n        </template>\r\n\r\n        <!-- 分页工具条 数据小于10条不展示 -->\r\n        <el-pagination\r\n                id=\"pageBar\"\r\n                v-show=\"totalCount >= 10\"\r\n                @size-change=\"handleSizeChange\"\r\n                @current-change=\"handleCurrentChange\"\r\n                :current-page=\"currentPage\"\r\n                :page-sizes=\"[5, 10, 15, 20, 50, 100]\"\r\n                :page-size=\"pageSize\"\r\n                layout=\"total, sizes, prev, pager, next, jumper\"\r\n                :total=\"totalCount\">\r\n        </el-pagination>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import Ckeditor4 from \"@/components/Ckeditor4\";\r\n    export default {\r\n        name: 'AdmCourseTab',\r\n        components:{\r\n            Ckeditor4,\r\n        },\r\n        data(){\r\n            return{\r\n                // 当前页码\r\n                currentPage: 1,\r\n                // 分页大小\r\n                pageSize: 10,\r\n                // 总页码数\r\n                totalCount: 99,\r\n                // 搜索表单数据模型\r\n                searchTitle:{\r\n                    courseName:'',\r\n                },\r\n                // 内置查询模型\r\n                searchByCourseName:{\r\n                    courseName:'',\r\n                },\r\n                // 数据列表\r\n                tableData:[],\r\n            }\r\n        },\r\n        created() {\r\n            this.getCourseByTitle();\r\n        },\r\n        methods:{\r\n            // 查找课程\r\n            // 系统内置一个title，默认为空，即全查询。每次条件查询都会把条件赋给该title。\r\n            // 因此这样点击分页栏时可以正常显示查询结果。\r\n            getCourseByTitle(){\r\n                this.searchByCourseName[\"pageSize\"]=this.pageSize;\r\n                this.searchByCourseName[\"currentPage\"]=this.currentPage;\r\n                this.$axios.post(\"/CourseView/getPageByCondition\",this.searchByCourseName).then((res)=>{\r\n                    if(res.data.flag){\r\n                        /* 保存公告数据 */\r\n                        this.tableData = res.data.data.records;\r\n                        /* 保存分页数据 */\r\n                        this.totalCount = res.data.data.total;\r\n                        this.currentPage = res.data.data.current;\r\n                        this.pageSize = res.data.data.size;\r\n                    }else{\r\n                        // 服务故障\r\n                        this.$message.error(\"信息获取失败！\");\r\n                    }\r\n                });\r\n            },\r\n            // 表格颜色控制\r\n            tableRowClassName({row, rowIndex}) {\r\n                if (rowIndex%4 === 1) {\r\n                    return 'warning-row';\r\n                } else if (rowIndex%4 === 3) {\r\n                    return 'success-row';\r\n                }\r\n                return '';\r\n            },\r\n            // 查询课程\r\n            searchOnSubmit(courseName){\r\n                // 刷新查询条件\r\n                this.searchByCourseName.courseName = courseName;\r\n                // 执行查询\r\n                this.getCourseByTitle();\r\n                /* 清空查询条件 */\r\n                this.searchTitle.courseName='';\r\n            },\r\n            // 课程管理\r\n            courseManage(course){\r\n                // 添加课程id到session\r\n                this.$axios.post(\"/CourseView/addCourseIdToSession\", course).then((res)=>{\r\n                    if(res.data.flag){\r\n                        this.$router.push({\r\n                            name:'AdmCourseManage',\r\n                            params:{\r\n                                courseId:course.courseId\r\n                            }\r\n                        });\r\n                    }else{\r\n                        // 服务故障\r\n                        this.$message.error(\"服务处理失败，请重新尝试T_T\");\r\n                    }\r\n                });\r\n            },\r\n            // 更新课程状态\r\n            updateCourseState(course){\r\n                // 更新状态\r\n                course.isStart = course.isStartBool ? 1:0;\r\n                let newCourse = {\r\n                    courseId:course.courseId,\r\n                    isStart:course.isStart,\r\n                }\r\n                this.$axios.post(\"/Course/updateInfo\",newCourse).then((res)=>{\r\n                    if(res.data.flag){\r\n                        // 修改成功\r\n                        this.$message.success(res.data.msg);\r\n                    }else{\r\n                        // 服务故障\r\n                        this.$message.error(res.data.msg);\r\n                    }\r\n                });\r\n            },\r\n            // 删除课程\r\n            deleteCourse(row){\r\n                // 弹框确认\r\n                this.$confirm('此操作将永久删除该课程及其所有数据，其所含学生将自动退出该课程, 是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    let course = {courseId:row.courseId};\r\n                    // 执行删除\r\n                    this.$axios.post(\"/Course/deleteCourseById\",course).then(resp=>{\r\n                        if(resp.data.flag){\r\n                            // 删除成功，刷新数据\r\n                            this.getCourseByTitle();\r\n                            this.$message.success('删除成功！');\r\n                        }else{\r\n                            this.$message.error('删除失败！');\r\n                        }\r\n                    })\r\n                }).catch(() => {\r\n                    // 取消删除\r\n                    this.$message.info('取消删除');\r\n                });\r\n            },\r\n            // 分页大小变化\r\n            handleSizeChange(val) {\r\n                this.pageSize = val;\r\n                // 查询所有课程\r\n                this.getCourseByTitle();\r\n            },\r\n            // 当前页变化\r\n            handleCurrentChange(val) {\r\n                this.currentPage = val;\r\n                // 查询所有课程\r\n                this.getCourseByTitle();\r\n            },\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    /* 搜索框 */\r\n    #file-form-select{\r\n        left: 200%;\r\n        margin-top: 20px;\r\n        position: relative;\r\n    }\r\n    /* 表格文字大小 */\r\n    .el-table{\r\n        font-size: 17px;\r\n    }\r\n    /* 选择开关 */\r\n    .tableSwitch{\r\n        position: relative;\r\n        bottom: 0.1em;\r\n    }\r\n    /* 表格行高控制 */\r\n    ::v-deep .el-table .el-table__cell{\r\n        padding: 9px 0;\r\n    }\r\n    /* 分页工具条上框 */\r\n    #pageBar{\r\n        margin-top: 20px;\r\n    }\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}